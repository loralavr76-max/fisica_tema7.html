<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>F√≠sica 3 ESO ¬∑ Tema 7 ‚Äì ¬øPor qu√© se mueven los cuerpos?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --primary: #295ee9;
      --primary-soft: #e7efff;
      --primary-dark: #16379c;
      --accent: #00c2ff;
      --danger: #ff4b6a;
      --bg: #f3f6ff;
      --card-bg: #ffffff;
      --text-main: #0e1630;
      --text-soft: #4a5678;
      --radius-lg: 20px;
      --radius-md: 14px;
      --radius-pill: 999px;
      --shadow-soft: 0 18px 40px rgba(10, 35, 120, 0.18);
      --transition-fast: 0.18s ease-out;
      --transition-med: 0.25s ease-out;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at 0% 0%, #8ed0ff 0, #f3f6ff 45%, #e5ebff 100%);
      color: var(--text-main);
      display: flex;
      justify-content: center;
      padding: 16px;
    }

    .app {
      width: 100%;
      max-width: 1200px;
      min-height: 90vh;
      background: linear-gradient(150deg, #0f172a 0%, #13214b 40%, #1f2937 100%);
      border-radius: 26px;
      box-shadow: var(--shadow-soft);
      color: #e5edff;
      display: grid;
      grid-template-columns: 280px 1fr;
      overflow: hidden;
      position: relative;
    }

    /* ==== –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê ‚Äì –ù–ê–í–ò–ì–ê–¶–ò–Ø ==== */

    .sidebar {
      background: radial-gradient(circle at top left, #295ee9 0%, #0f172a 55%);
      padding: 22px 20px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      border-right: 1px solid rgba(255, 255, 255, 0.06);
    }

    .logo-block {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-circle {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: conic-gradient(from 220deg, #00c2ff, #7dd3fc, #38bdf8, #00c2ff);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #0b1120;
      font-weight: 800;
      font-size: 20px;
      box-shadow: 0 0 0 3px rgba(15,23,42,0.4);
    }

    .logo-text-title {
      font-size: 14px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #bfdbfe;
    }

    .logo-text-sub {
      font-size: 12px;
      color: #9fb5ff;
    }

    .subject-pill {
      margin-top: 8px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: var(--radius-pill);
      background: rgba(15,23,42,0.75);
      font-size: 11px;
      color: #e0f2fe;
      border: 1px solid rgba(148, 163, 253, 0.5);
    }

    .subject-pill span.flag {
      font-size: 16px;
    }

    .sidebar-section-title {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #94a3ff;
      margin-top: 8px;
      margin-bottom: -2px;
    }

    .unit-list {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .unit-pill {
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 13px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      background: rgba(15,23,42,0.35);
      color: #dbeafe;
      border: 1px solid transparent;
      cursor: pointer;
      transition: var(--transition-fast);
    }
    .unit-pill.active {
      background: rgba(37, 99, 235, 0.95);
      border-color: rgba(191, 219, 254, 0.7);
      box-shadow: 0 10px 24px rgba(37,99,235,0.6);
    }
    .unit-pill small {
      font-size: 11px;
      color: #a5b4fc;
    }

    .unit-tag {
      font-size: 11px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(15,23,42,0.7);
      color: #e0f2fe;
    }

    .nav-links {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .nav-link {
      font-size: 12px;
      color: #c7d2fe;
      opacity: 0.85;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 8px;
      border-radius: 999px;
      transition: var(--transition-fast);
    }
    .nav-link:hover {
      background: rgba(15,23,42,0.6);
      opacity: 1;
    }

    .nav-link span.icon {
      width: 18px;
      text-align: center;
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 11px;
      color: #9ca3ff;
      opacity: 0.85;
    }

    .family-mode-badge {
      margin-top: 6px;
      padding: 7px 10px;
      border-radius: 16px;
      background: rgba(15,23,42,0.7);
      border: 1px solid rgba(148,163,253,0.6);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 11px;
      color: #e0f2fe;
    }

    .family-mode-badge span.left {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .avatar-stack {
      display: flex;
      align-items: center;
    }
    .avatar {
      width: 20px;
      height: 20px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #fee2e2, #fb7185);
      border: 2px solid #020617;
      margin-left: -6px;
    }
    .avatar:first-child { margin-left: 0; }

    .family-switch {
      background: rgba(15,23,42,0.9);
      border-radius: 999px;
      padding: 2px;
      display: flex;
      gap: 2px;
    }
    .family-switch span {
      padding: 3px 6px;
      border-radius: 999px;
      cursor: default;
    }
    .family-switch span.active {
      background: #22c55e;
      color: #022c22;
      font-weight: 600;
    }

    /* ==== –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê ==== */

    .main {
      padding: 22px 22px 22px 0;
      display: flex;
      flex-direction: column;
      gap: 16px;
      overflow: hidden;
    }

    .main-inner {
      background: radial-gradient(circle at top right, rgba(56,189,248,0.22) 0%, rgba(15,23,42,0.4) 40%, rgba(15,23,42,0.95) 100%);
      border-radius: 24px;
      padding: 18px 20px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      height: 100%;
      overflow: hidden;
      border: 1px solid rgba(148,163,253,0.4);
    }

    /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å */

    .top-row {
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }

    .breadcrumbs {
      font-size: 11px;
      color: #a5b4fc;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .breadcrumbs span {
      color: #e0f2fe;
    }

    .search-and-toggle {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-left: auto;
      flex-wrap: wrap;
    }

    .search-box {
      background: rgba(15,23,42,0.9);
      border-radius: 999px;
      padding: 6px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      border: 1px solid rgba(148,163,253,0.7);
      min-width: 230px;
    }
    .search-box input {
      border: none;
      background: transparent;
      color: #e5edff;
      font-size: 13px;
      width: 100%;
      outline: none;
    }
    .search-box input::placeholder {
      color: #64748b;
    }

    .translate-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: #bfdbfe;
    }
    .toggle {
      width: 36px;
      height: 20px;
      border-radius: 999px;
      background: rgba(15,23,42,0.8);
      border: 1px solid rgba(148,163,253,0.7);
      display: flex;
      align-items: center;
      padding: 2px;
      cursor: pointer;
      position: relative;
      transition: var(--transition-fast);
    }
    .toggle-thumb {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #e5edff;
      transform: translateX(0);
      transition: var(--transition-fast);
    }
    .toggle.on {
      background: #22c55e;
      border-color: #4ade80;
    }
    .toggle.on .toggle-thumb {
      transform: translateX(14px);
      background: #f9fafb;
    }

    /* –ü—Ä–æ–≥—Ä–µ—Å—Å */

    .progress-row {
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
      margin-top: 4px;
    }

    .progress-main {
      flex: 1;
      min-width: 220px;
      background: rgba(15,23,42,0.85);
      border-radius: var(--radius-lg);
      padding: 10px 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      border: 1px solid rgba(148,163,253,0.5);
    }

    .progress-circle {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: conic-gradient(from 270deg, #4ade80 var(--prog-deg), rgba(148,163,253,0.35) 0);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      color: #ecfdf5;
      font-weight: 600;
      box-shadow: 0 0 0 3px rgba(22,163,74,0.28);
    }

    .progress-text {
      font-size: 11px;
      color: #c7d2fe;
    }
    .progress-text strong { color: #e5edff; }

    .progress-bar-wrapper {
      flex: 1;
      height: 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #22c55e, #4ade80, #a7f3d0);
      transition: width var(--transition-med);
    }

    .session-info {
      min-width: 170px;
      background: rgba(15,23,42,0.9);
      border-radius: var(--radius-md);
      padding: 8px 10px;
      font-size: 11px;
      border: 1px solid rgba(148,163,253,0.4);
      color: #c7d2fe;
    }
    .session-info strong {
      color: #facc15;
    }

    /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ –¢–µ–æ—Ä–∏—è / –¢–µ—Å—Ç—ã / –°–ª–æ–≤–∞—Ä—å */

    .mode-tabs {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      padding: 4px;
      background: rgba(15,23,42,0.85);
      border: 1px solid rgba(148,163,253,0.5);
      margin-top: 4px;
    }

    .mode-tab {
      border-radius: 999px;
      padding: 5px 12px;
      font-size: 12px;
      color: #cbd5f5;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: var(--transition-fast);
    }
    .mode-tab span.icon { font-size: 14px; }
    .mode-tab.active {
      background: #eff6ff;
      color: #1e293b;
      font-weight: 600;
      box-shadow: 0 10px 20px rgba(191,219,254,0.3);
    }

    /* –ö–æ–Ω—Ç–µ–Ω—Ç */

    .content-area {
      margin-top: 8px;
      display: grid;
      grid-template-columns: 3fr 220px;
      gap: 14px;
      height: calc(100% - 110px);
    }

    @media (max-width: 980px) {
      .app {
        grid-template-columns: 1fr;
      }
      .sidebar {
        display: none;
      }
      .main {
        padding: 16px;
      }
      .content-area {
        grid-template-columns: 1fr;
        height: auto;
      }
    }

    .cards-scroll {
      overflow: auto;
      padding-right: 4px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .theory-card {
      background: radial-gradient(circle at top left, rgba(59,130,246,0.18) 0, rgba(15,23,42,0.9) 40%);
      border-radius: var(--radius-lg);
      padding: 12px 14px 12px 14px;
      border: 1px solid rgba(148,163,253,0.55);
      position: relative;
      overflow: hidden;
      transition: var(--transition-med);
      cursor: default;
    }

    .theory-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 18px 40px rgba(15,23,42,0.9);
      border-color: rgba(191,219,254,0.9);
    }

    .theory-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }

    .theory-title {
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #e5edff;
    }
    .theory-title span.dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #38bdf8;
      box-shadow: 0 0 12px #38bdf8;
    }

    .theory-ref {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.85);
      border: 1px solid rgba(148,163,253,0.7);
      color: #bfdbfe;
    }

    .theory-text {
      font-size: 13px;
      line-height: 1.45;
      color: #e2e8f0;
      margin-bottom: 6px;
    }

    .theory-text .highlight {
      color: #facc15;
      font-weight: 600;
    }

    .translation {
      font-size: 13px;
      line-height: 1.4;
      color: #cbd5f5;
      margin-top: 4px;
      border-top: 1px dashed rgba(148,163,253,0.5);
      padding-top: 4px;
      display: none;
    }

    .chip-row {
      margin-top: 6px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .chip {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15,23,42,0.8);
      color: #e0f2fe;
      border: 1px solid rgba(148,163,253,0.6);
      cursor: pointer;
      transition: var(--transition-fast);
    }
    .chip:hover {
      background: #eff6ff;
      color: #1e293b;
    }

    .badge-math {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15,23,42,0.8);
      color: #91f0ff;
      border: 1px solid rgba(45,212,191,0.7);
      margin-left: 4px;
    }

    /* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ ‚Äì —Ç–µ—Å—Ç—ã –∏ —Å–ª–æ–≤–∞—Ä—å */

    .right-panel {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .panel-card {
      background: rgba(15,23,42,0.95);
      border-radius: var(--radius-md);
      border: 1px solid rgba(148,163,253,0.6);
      padding: 10px;
    }

    .panel-title {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #e5edff;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .panel-title span.icon { font-size: 15px; }

    .mini-text {
      font-size: 11px;
      color: #cbd5f5;
      margin-bottom: 6px;
    }

    .test-question {
      font-size: 12px;
      color: #e5edff;
      margin-bottom: 6px;
    }

    .test-options {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 4px;
    }

    .test-option {
      font-size: 11px;
      padding: 5px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,253,0.7);
      cursor: pointer;
      color: #cbd5f5;
      background: rgba(15,23,42,0.8);
      transition: var(--transition-fast);
    }
    .test-option:hover {
      background: rgba(59,130,246,0.7);
      border-color: rgba(191,219,254,0.9);
      color: #f9fafb;
    }
    .test-option.correct {
      background: rgba(34,197,94,0.9);
      border-color: #bbf7d0;
      color: #052e16;
    }
    .test-option.wrong {
      background: rgba(239,68,68,0.9);
      border-color: #fecaca;
      color: #fef2f2;
    }

    .test-feedback {
      font-size: 11px;
      min-height: 14px;
      color: #cbd5f5;
    }

    .panel-divider {
      border-top: 1px dashed rgba(148,163,253,0.5);
      margin: 6px 0;
    }

    /* –°–ª–æ–≤–∞—Ä–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä */

    .vocab-word {
      font-size: 13px;
      font-weight: 600;
      color: #e0f2fe;
      margin-bottom: 4px;
    }
    .vocab-word span.lang {
      font-size: 10px;
      text-transform: uppercase;
      color: #93c5fd;
      margin-left: 4px;
    }

    .vocab-answer {
      width: 100%;
      border-radius: 999px;
      border: 1px solid rgba(148,163,253,0.7);
      background: rgba(15,23,42,0.9);
      padding: 5px 8px;
      font-size: 12px;
      color: #e5edff;
      outline: none;
      margin-bottom: 4px;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 4px;
    }

    .small-pill {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148,163,253,0.6);
      font-size: 10px;
      color: #bfdbfe;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 5px 10px;
      font-size: 11px;
      cursor: pointer;
      background: #38bdf8;
      color: #0f172a;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition: var(--transition-fast);
    }
    .btn:hover {
      background: #e0f2fe;
    }
    .btn.secondary {
      background: transparent;
      color: #bfdbfe;
      border: 1px solid rgba(148,163,253,0.7);
    }
    .btn.secondary:hover {
      background: rgba(15,23,42,0.8);
    }

    .vocab-feedback {
      font-size: 11px;
      min-height: 14px;
      color: #cbd5f5;
      margin-top: 2px;
    }

    /* –°–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ */

    .mode-tests .cards-scroll .theory-card {
      opacity: 0.96;
    }
    .mode-vocab .cards-scroll .theory-card {
      opacity: 0.92;
    }

  </style>
</head>
<body>
<div class="app">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="logo-block">
      <div class="logo-circle">F</div>
      <div>
        <div class="logo-text-title">F√≠sica y Qu√≠mica</div>
        <div class="logo-text-sub">3.¬∫ ESO ¬∑ Comunidad Valenciana</div>
      </div>
    </div>

    <div class="subject-pill">
      <span class="flag">‚öõÔ∏è</span>
      <span>Tema 7 ¬∑ ¬øPor qu√© se mueven los cuerpos?</span>
    </div>

    <div class="sidebar-section-title">Unidades</div>
    <div class="unit-list">
      <div class="unit-pill active">
        <div>
          <div>Tema 7 ¬∑ Fuerzas y movimiento</div>
          <small>Leyes de Newton ¬∑ Rozamiento ¬∑ Aceleraci√≥n</small>
        </div>
        <span class="unit-tag">En estudio</span>
      </div>
      <div class="unit-pill">
        <div>
          <div>Geografia 3.1</div>
          <small>Unitat 2 ¬∑ Reptes demogr√†fics</small>
        </div>
        <span class="unit-tag">üü£ Ir</span>
      </div>
    </div>

    <div class="nav-links">
      <a class="nav-link" href="index.html">
        <span class="icon">üè†</span>
        <span>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (–µ—Å–ª–∏ –±—É–¥–µ—Ç)</span>
      </a>
      <a class="nav-link" href="geografia_u2.html">
        <span class="icon">üü£</span>
        <span>A la Geografia ¬∑ U2</span>
      </a>
    </div>

    <div class="sidebar-footer">
      <div class="family-mode-badge">
        <span class="left">
          <div class="avatar-stack">
            <div class="avatar"></div>
            <div class="avatar"></div>
          </div>
          <span>Modo families ¬∑ Study</span>
        </span>
        <div class="family-switch">
          <span class="active">ON</span>
          <span>OFF</span>
        </div>
      </div>
      <div style="margin-top:8px;">
        ‚è± El pare pot veure el temps d‚Äôestudi i les respostes als tests.
      </div>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <div class="main-inner" id="main-inner">
      <div class="top-row">
        <div>
          <div class="breadcrumbs">
            F√çSICA 3 ESO ¬∑ <span>Tema 7 ¬∑ Forces i moviment</span>
          </div>
          <div style="font-size:18px;font-weight:600;color:#e5edff;margin-top:2px;">
            ¬øPor qu√© se mueven los cuerpos? ¬∑ <span style="color:#93c5fd;">Leyes de Newton, peso y rozamiento</span>
          </div>
        </div>

        <div class="search-and-toggle">
          <div class="search-box">
            <span style="font-size:14px;">üîç</span>
            <input id="searchInput" type="text" placeholder="Buscar en el texto / –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–º–µ‚Ä¶" />
          </div>

          <div class="translate-toggle">
            –ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥ (RU)
            <div class="toggle" id="toggleTranslate">
              <div class="toggle-thumb"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="progress-row">
        <div class="progress-main">
          <div class="progress-circle" id="progressCircle">0%</div>
          <div style="flex:1;">
            <div class="progress-text">
              –ü—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ–º—ã: <strong id="progressLabel">0 / 10 –∑–∞–¥–∞–Ω–∏–π</strong>
            </div>
            <div class="progress-bar-wrapper">
              <div class="progress-bar" id="progressBar"></div>
            </div>
          </div>
        </div>

        <div class="session-info" id="sessionInfo">
          –í—Ä–µ–º—è –∑–∞–Ω—è—Ç–∏—è —Å–µ–≥–æ–¥–Ω—è: <strong>0 –º–∏–Ω</strong><br />
          –í—Å–µ–≥–æ –ø–æ —Ç–µ–º–µ: <span id="totalMinutes">0 –º–∏–Ω</span>
        </div>

        <div class="mode-tabs" id="modeTabs">
          <div class="mode-tab active" data-mode="theory">
            <span class="icon">üìò</span> –¢–µ–æ—Ä–∏—è
          </div>
          <div class="mode-tab" data-mode="tests">
            <span class="icon">‚úÖ</span> –¢–µ—Å—Ç—ã
          </div>
          <div class="mode-tab" data-mode="vocab">
            <span class="icon">üß†</span> –°–ª–æ–≤–∞—Ä—å
          </div>
        </div>
      </div>

      <div class="content-area" id="contentArea">
        <div class="cards-scroll" id="cardsContainer">
          <!-- –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ–æ—Ä–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç–æ–º -->
        </div>

        <div class="right-panel">
          <div class="panel-card" id="testPanel">
            <div class="panel-title">
              <span class="icon">üß©</span> –ú–∏–Ω–∏-—Ç–µ—Å—Ç
            </div>
            <div class="mini-text">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ–º—ã. –í–æ–ø—Ä–æ—Å—ã –º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</div>
            <div class="test-question" id="testQuestion"></div>
            <div class="test-options" id="testOptions"></div>
            <div class="test-feedback" id="testFeedback"></div>
          </div>

          <div class="panel-card" id="vocabPanel">
            <div class="panel-title">
              <span class="icon">üß†</span> –¢—Ä–µ–Ω–∞–∂—ë—Ä —Å–ª–æ–≤
            </div>
            <div class="mini-text">–ò—Å–ø–∞–Ω—Å–∫–∏–π ‚Üî —Ä—É—Å—Å–∫–∏–π. –ú–æ–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å —Å–ª–æ–≤–∞–º–∏ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–∞—Ç—å ¬´–ü–æ–∫–∞–∑–∞—Ç—å¬ª.</div>

            <div class="vocab-word" id="vocabWord">
              <!-- —Å–ª–æ–≤–æ -->
            </div>
            <input class="vocab-answer" id="vocabAnswer" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥‚Ä¶" />
            <div class="pill-row">
              <button class="btn" id="checkVocab">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
              <button class="btn secondary" id="showVocab">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</button>
            </div>
            <div class="vocab-feedback" id="vocabFeedback"></div>

            <div class="panel-divider"></div>
            <div class="mini-text">
              –†–µ–∂–∏–º: <span id="vocabModeLabel">ES ‚Üí RU</span><br />
              <button class="btn secondary" id="switchVocabMode" style="margin-top:4px;">–ü–æ–º–µ–Ω—è—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
            </div>
          </div>

          <div class="panel-card">
            <div class="panel-title">
              <span class="icon">üìä</span> –§–æ—Ä–º—É–ª—ã —Ç–µ–º—ã
            </div>
            <div class="mini-text">
              <span class="small-pill">2¬™ ley de Newton</span> <br />
              <strong style="font-size:13px;">F = m ¬∑ a</strong> ‚Äì —Å–∏–ª–∞ —Ä–∞–≤–Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é –º–∞—Å—Å—ã –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ.
            </div>
            <div class="mini-text">
              <span class="small-pill">Peso</span> <br />
              <strong style="font-size:13px;">P = m ¬∑ g</strong> ‚Äì –≤–µ—Å —Ç–µ–ª–∞, g ‚âà 9,8 m/s¬≤ –Ω–∞ –ó–µ–º–ª–µ.
            </div>
            <div class="mini-text">
              <span class="small-pill">Rozamiento</span> <br />
              <strong style="font-size:13px;">F<sub>r</sub> = Œº ¬∑ N</strong> ‚Äì —Å–∏–ª–∞ —Ç—Ä–µ–Ω–∏—è = –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç ¬∑ —Å–∏–ª–∞ –Ω–æ—Ä–º–∞–ª–∏.
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<script><script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
const supa = supabase.createClient(
  "https://peynomitdenvbdtlvnuz.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBleW5vbWl0ZGVudmJkdGx2bnV6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMTg3MDksImV4cCI6MjA3ODg5NDcwOX0.jNrNDqlxfiG8XzIN9ChQnvhKIIbh0QGUcNMHWHO_uUk"
);

  // ====== –î–ê–ù–ù–´–ï –¢–ï–ú–´ ======

  const topics = [
    {
      id: 'newton1',
      ref: '5.1 ¬∑ Primera ley de Newton',
      title: '1. Primera ley de Newton o ley de la inercia',
      text_ca: 'Un cuerpo se mantendr√° en su estado de movimiento, ya sea en reposo o a velocidad constante, si no se le obliga a cambiar por la acci√≥n de una o varias fuerzas que act√∫an sobre √©l.',
      text_ru: '–¢–µ–ª–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫–æ—è –∏–ª–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è, –ø–æ–∫–∞ –Ω–∞ –Ω–µ–≥–æ –Ω–µ –ø–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–∏–ª–∞, –∑–∞—Å—Ç–∞–≤–ª—è—é—â–∞—è –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –≠—Ç–æ –∏ –µ—Å—Ç—å –∑–∞–∫–æ–Ω –∏–Ω–µ—Ä—Ü–∏–∏.',
      keywords: ['In√®rcia ¬∑ –ò–Ω–µ—Ä—Ü–∏—è', 'For√ßa neta ¬∑ –†–∞–≤–Ω–æ–¥–µ–π—Å—Ç–≤—É—é—â–∞—è —Å–∏–ª–∞', 'Equilibri ¬∑ –†–∞–≤–Ω–æ–≤–µ—Å–∏–µ']
    },
    {
      id: 'newton2',
      ref: '5.2 ¬∑ Segunda ley de Newton',
      title: '2. Segunda ley de Newton o ley del movimiento',
      text_ca: 'Si sobre un cuerpo act√∫a una fuerza neta, este adquiere una aceleraci√≥n directamente proporcional a la fuerza que act√∫a sobre √©l e inversamente proporcional a la masa: F = m ¬∑ a.',
      text_ru: '–ï—Å–ª–∏ –Ω–∞ —Ç–µ–ª–æ –¥–µ–π—Å—Ç–≤—É–µ—Ç —Ä–∞–≤–Ω–æ–¥–µ–π—Å—Ç–≤—É—é—â–∞—è —Å–∏–ª–∞, –æ–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ, –ø—Ä—è–º–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —ç—Ç–æ–π —Å–∏–ª–µ –∏ –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –º–∞—Å—Å–µ: F = m ¬∑ a.',
      keywords: ['Aceleraci√≥ ¬∑ –£—Å–∫–æ—Ä–µ–Ω–∏–µ', 'F = m ¬∑ a', 'Unitat: N (newton)']
    },
    {
      id: 'newton3',
      ref: '5.3 ¬∑ Tercera ley',
      title: '3. Tercera ley de Newton o ley de acci√≥n y reacci√≥n',
      text_ca: 'Si un cuerpo ejerce una fuerza sobre otro, este ejerce una fuerza igual, pero en sentido contrario, sobre el primero. Ambas fuerzas forman un par acci√≥-reacci√≥.',
      text_ru: '–ï—Å–ª–∏ –æ–¥–Ω–æ —Ç–µ–ª–æ –¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞ –¥—Ä—É–≥–æ–µ —Å –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Å–∏–ª–æ–π, –≤—Ç–æ—Ä–æ–µ —Ç–µ–ª–æ –¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞ –ø–µ—Ä–≤–æ–µ —Å —Å–∏–ª–æ–π —Ç–∞–∫–æ–π –∂–µ –≤–µ–ª–∏—á–∏–Ω—ã, –Ω–æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –≠—Ç–∏ —Å–∏–ª—ã –Ω–∞–∑—ã–≤–∞—é—Ç –ø–∞—Ä–æ–π –¥–µ–π—Å—Ç–≤–∏–µ‚Äì–ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ.',
      keywords: ['Acci√≥ ¬∑ –î–µ–π—Å—Ç–≤–∏–µ', 'Reacci√≥ ¬∑ –ü—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ', 'Parell de forces ¬∑ –ü–∞—Ä–∞ —Å–∏–ª']
    },
    {
      id: 'weight',
      ref: '5.4 ¬∑ Peso y gravedad',
      title: '4. El peso y la fuerza de la gravedad',
      text_ca: 'El peso es la fuerza con que nos atrae la gravedad de un astro o planeta. Se calcula con la ecuaci√≥n P = m ¬∑ g, on g √©s l\'acceleraci√≥ de la gravetat.',
      text_ru: '–í–µ—Å ‚Äî —ç—Ç–æ —Å–∏–ª–∞, —Å –∫–æ—Ç–æ—Ä–æ–π –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏—è –ø–ª–∞–Ω–µ—Ç—ã –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç —Ç–µ–ª–æ. –í–µ—Å –≤—ã—á–∏—Å–ª—è—é—Ç –ø–æ —Ñ–æ—Ä–º—É–ª–µ P = m ¬∑ g, –≥–¥–µ g ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø–∞–¥–µ–Ω–∏—è.',
      keywords: ['Pes ¬∑ –í–µ—Å', 'Gravetat ¬∑ –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è', 'P = m ¬∑ g']
    },
    {
      id: 'friction_basic',
      ref: '6.1 ¬∑ La fuerza de rozamiento',
      title: '5. La fuerza de rozamiento',
      text_ca: 'La fuerza de rozamiento se opone al movimiento de los cuerpos y aparece por el contacto entre superficies. Su direcci√≥n es la misma que la del movimiento pero en sentido contrario.',
      text_ru: '–°–∏–ª–∞ —Ç—Ä–µ–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—é —Ç–µ–ª–∞ –∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π. –û–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–¥–æ–ª—å –¥–≤–∏–∂–µ–Ω–∏—è, –Ω–æ –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É.',
      keywords: ['Fricci√≥ ¬∑ –¢—Ä–µ–Ω–∏–µ', 'Contacte ¬∑ –ö–æ–Ω—Ç–∞–∫—Ç', 'For√ßa de rozamiento ¬∑ –°–∏–ª–∞ —Ç—Ä–µ–Ω–∏—è']
    },
    {
      id: 'friction_coeff',
      ref: '6.2 ¬∑ Coeficiente de rozamiento',
      title: '6. Coeficiente de rozamiento: est√°tico y din√°mico',
      text_ca: 'Per quantificar el rozamiento definim el coeficiente Œº. El coeficiente est√†tic (Œºs) correspon a quan el cos est√† en rep√≤s i cal una for√ßa m√©s gran per comen√ßar a moure\'l. El coeficient din√†mic (Œºd) actua quan el cos ja est√† en moviment.',
      text_ru: '–ß—Ç–æ–±—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Ç—Ä–µ–Ω–∏–µ, –≤–≤–æ–¥—è—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œº. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œºs –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –ø–æ–∫–æ—è: —á—Ç–æ–±—ã —Å–¥–≤–∏–Ω—É—Ç—å —Ç–µ–ª–æ, –Ω—É–∂–Ω–∞ –±–æ–ª—å—à–∞—è —Å–∏–ª–∞. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œºd –¥–µ–π—Å—Ç–≤—É–µ—Ç, –∫–æ–≥–¥–∞ —Ç–µ–ª–æ —É–∂–µ –¥–≤–∏–∂–µ—Ç—Å—è, –∏ –æ–±—ã—á–Ω–æ –æ–Ω –º–µ–Ω—å—à–µ.',
      keywords: ['Œºs ¬∑ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç—Ä–µ–Ω–∏—è', 'Œºd ¬∑ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ç—Ä–µ–Ω–∏—è', 'F = Œº ¬∑ N']
    },
    {
      id: 'acceleration',
      ref: '7.1 ¬∑ La aceleraci√≥n de los cuerpos',
      title: '7. Aceleraci√≥n de los cuerpos en ca√≠da',
      text_ca: 'Quan un objecte cau des d\'una altura, cada vegada baixa m√©s r√†pid: la seva velocitat augmenta cada segon. Aix√≤ passa perqu√® actua una acceleraci√≥ gaireb√© constant deguda a la gravetat.',
      text_ru: '–ö–æ–≥–¥–∞ —Ç–µ–ª–æ –ø–∞–¥–∞–µ—Ç —Å –≤—ã—Å–æ—Ç—ã, –æ–Ω–æ –¥–≤–∏–∂–µ—Ç—Å—è –≤—Å—ë –±—ã—Å—Ç—Ä–µ–µ: –µ–≥–æ —Å–∫–æ—Ä–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É. –ü—Ä–∏—á–∏–Ω–∞ ‚Äî –ø–æ—á—Ç–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø–∞–¥–µ–Ω–∏—è.',
      keywords: ['Aceleraci√≥ ¬∑ –£—Å–∫–æ—Ä–µ–Ω–∏–µ', 'Caiguda lliure ¬∑ –°–≤–æ–±–æ–¥–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ', 'g ‚âà 9,8 m/s¬≤']
    },
    {
      id: 'summary',
      ref: 'Mapa conceptual ¬∑ Tema 7',
      title: '8. Resumen: mapa conceptual de fuerzas y movimiento',
      text_ca: 'El moviment d\'un cos es descriu a partir del canvi en la seva posici√≥ al llarg del temps. Les forces expliquen per qu√® canvia aquest moviment: les lleis de Newton relacionen for√ßa, massa i acceleraci√≥, mentre que el pes i el rozament s√≥n forces especials que actuen en moltes situacions quotidianes.',
      text_ru: '–î–≤–∏–∂–µ–Ω–∏–µ —Ç–µ–ª–∞ –æ–ø–∏—Å—ã–≤–∞—é—Ç —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏. –°–∏–ª—ã –æ–±—ä—è—Å–Ω—è—é—Ç, –ø–æ—á–µ–º—É –¥–≤–∏–∂–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è: –∑–∞–∫–æ–Ω—ã –ù—å—é—Ç–æ–Ω–∞ —Å–≤—è–∑—ã–≤–∞—é—Ç —Å–∏–ª—É, –º–∞—Å—Å—É –∏ —É—Å–∫–æ—Ä–µ–Ω–∏–µ, –∞ –≤–µ—Å –∏ —Å–∏–ª–∞ —Ç—Ä–µ–Ω–∏—è ‚Äî —ç—Ç–æ –æ—Å–æ–±—ã–µ —Å–∏–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –¥–µ–π—Å—Ç–≤—É—é—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏.',
      keywords: ['Moviment ¬∑ –î–≤–∏–∂–µ–Ω–∏–µ', 'Forces ¬∑ –°–∏–ª—ã', 'Lleis de Newton ¬∑ –ó–∞–∫–æ–Ω—ã –ù—å—é—Ç–æ–Ω–∞']
    }
  ];

  const tests = [
    {
      topicId: 'newton1',
      q: 'Seg√∫n la primera ley de Newton, un cuerpo mantiene su estado de movimiento si‚Ä¶',
      options: [
        'no act√∫a ninguna fuerza neta sobre √©l',
        'su masa es muy peque√±a',
        'se mueve solo en l√≠nea recta'
      ],
      correct: 0,
      explain: 'Mientras la fuerza neta sea cero, el cuerpo mantiene su estado (reposo o MRU).'
    },
    {
      topicId: 'newton2',
      q: 'En la ecuaci√≥n F = m ¬∑ a, si duplicamos la fuerza y mantenemos la masa, la aceleraci√≥n‚Ä¶',
      options: [
        'se reduce a la mitad',
        'se mantiene igual',
        'se duplica'
      ],
      correct: 2,
      explain: 'a = F / m, por tanto si F se duplica y m es constante, a tambi√©n se duplica.'
    },
    {
      topicId: 'newton3',
      q: '¬øQu√© par de fuerzas es un ejemplo claro de acci√≥n y reacci√≥n?',
      options: [
        'El peso de un cuerpo y su rozamiento',
        'El empuje del patinador sobre el suelo y la reacci√≥n del suelo',
        'El peso de un cuerpo y la normal'
      ],
      correct: 1,
      explain: 'El patinador empuja hacia atr√°s el suelo y el suelo reacciona empuj√°ndolo hacia delante.'
    },
    {
      topicId: 'weight',
      q: 'Si un objeto tiene masa de 10 kg, su peso en la Tierra (g ‚âà 9,8 m/s¬≤) es aproximadamente‚Ä¶',
      options: [
        '9,8 N',
        '98 N',
        '0,98 N'
      ],
      correct: 1,
      explain: 'P = m ¬∑ g = 10 ¬∑ 9,8 ‚âà 98 N.'
    },
    {
      topicId: 'friction_basic',
      q: 'La fuerza de rozamiento siempre tiene sentido‚Ä¶',
      options: [
        'igual que el movimiento',
        'contrario al movimiento relativo entre superficies',
        'vertical hacia abajo'
      ],
      correct: 1,
      explain: 'El rozamiento se opone al deslizamiento relativo.'
    },
    {
      topicId: 'friction_coeff',
      q: 'El coeficiente de rozamiento est√°tico Œºs suele ser‚Ä¶',
      options: [
        'igual al din√°mico Œºd',
        'mayor que el din√°mico Œºd',
        'menor que el din√°mico Œºd'
      ],
      correct: 1,
      explain: 'Normalmente cuesta m√°s iniciar el movimiento que mantenerlo, por eso Œºs > Œºd.'
    },
    {
      topicId: 'acceleration',
      q: 'En ca√≠da libre (sin rozamiento), la aceleraci√≥n del cuerpo‚Ä¶',
      options: [
        'aumenta con el tiempo',
        'es aproximadamente constante e igual a g',
        'es cero'
      ],
      correct: 1,
      explain: 'En las cercan√≠as de la superficie terrestre, g se considera constante.'
    },
    {
      topicId: 'summary',
      q: '¬øQu√© magnitud relaciona la segunda ley de Newton?',
      options: [
        'Energ√≠a, tiempo y distancia',
        'Fuerza, masa y aceleraci√≥n',
        'Peso, volumen y densidad'
      ],
      correct: 1,
      explain: 'La 2¬™ ley conecta fuerza resultante, masa y aceleraci√≥n (F = m ¬∑ a).'
    },
    {
      topicId: 'summary',
      q: 'El peso de un cuerpo es‚Ä¶',
      options: [
        'la cantidad de materia que contiene',
        'la fuerza con que la gravedad lo atrae',
        'su volumen en litros'
      ],
      correct: 1,
      explain: 'La cantidad de materia es la masa; el peso es una fuerza.'
    },
    {
      topicId: 'friction_basic',
      q: 'Si no hubiera rozamiento, un coche que se mueve seguir√≠a‚Ä¶',
      options: [
        'deteni√©ndose poco a poco',
        'con velocidad constante mientras no act√∫e otra fuerza',
        'acelerando cada vez m√°s'
      ],
      correct: 1,
      explain: 'Sin fuerzas externas (como el rozamiento), se cumple estrictamente la 1¬™ ley de Newton.'
    }
  ];

  const vocab = [
    { es: 'fuerza', ru: '—Å–∏–ª–∞' },
    { es: 'aceleraci√≥n', ru: '—É—Å–∫–æ—Ä–µ–Ω–∏–µ' },
    { es: 'masa', ru: '–º–∞—Å—Å–∞' },
    { es: 'peso', ru: '–≤–µ—Å' },
    { es: 'rozamiento / fricci√≥n', ru: '—Ç—Ä–µ–Ω–∏–µ' },
    { es: 'coeficiente de rozamiento', ru: '–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç—Ä–µ–Ω–∏—è' },
    { es: 'movimiento rectil√≠neo uniforme (MRU)', ru: '—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ' },
    { es: 'ley de la inercia', ru: '–∑–∞–∫–æ–Ω –∏–Ω–µ—Ä—Ü–∏–∏' },
    { es: 'acci√≥n y reacci√≥n', ru: '–¥–µ–π—Å—Ç–≤–∏–µ –∏ –ø—Ä–æ—Ç–∏–≤–æ–¥–µ–π—Å—Ç–≤–∏–µ' },
    { es: 'fuerza resultante (neta)', ru: '—Ä–∞–≤–Ω–æ–¥–µ–π—Å—Ç–≤—É—é—â–∞—è —Å–∏–ª–∞' }
  ];

  // ====== –†–ï–ù–î–ï–† –ö–ê–†–¢–û–ß–ï–ö ======

  const cardsContainer = document.getElementById('cardsContainer');
  let showTranslation = false;

  function renderCards(filterText = '') {
    cardsContainer.innerHTML = '';
    const text = filterText.trim().toLowerCase();

    topics.forEach(topic => {
      if (text) {
        const combined = (topic.title + topic.text_ca + topic.text_ru + topic.keywords.join(' ')).toLowerCase();
        if (!combined.includes(text)) return;
      }

      const card = document.createElement('section');
      card.className = 'theory-card';
      card.dataset.topicId = topic.id;

      card.innerHTML = `
        <header class="theory-header">
          <div class="theory-title">
            <span class="dot"></span>
            <span>${topic.title}</span>
          </div>
          <div class="theory-ref">${topic.ref}</div>
        </header>
        <div class="theory-text">${topic.text_ca}</div>
        <div class="translation"${showTranslation ? '' : ' style="display:none;"'}>
          ${topic.text_ru}
        </div>
        <div class="chip-row">
          ${topic.keywords.map(k => `<button class="chip" data-chip="${k}">${k}</button>`).join('')}
        </div>
      `;

      cardsContainer.appendChild(card);
    });
  }

  renderCards();

  // ====== –ü–û–ò–°–ö ======
  document.getElementById('searchInput').addEventListener('input', (e) => {
    renderCards(e.target.value);
  });

  // ====== –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –ü–ï–†–ï–í–û–î–ê ======
  const toggleTranslate = document.getElementById('toggleTranslate');
  toggleTranslate.addEventListener('click', () => {
    showTranslation = !showTranslation;
    toggleTranslate.classList.toggle('on', showTranslation);

    document.querySelectorAll('.translation').forEach(el => {
      el.style.display = showTranslation ? 'block' : 'none';
    });
  });

  // ====== –¢–ï–°–¢–´ –ò –ü–†–û–ì–†–ï–°–° ======
  let currentTestIndex = 0;
  const testQuestion = document.getElementById('testQuestion');
  const testOptions = document.getElementById('testOptions');
  const testFeedback = document.getElementById('testFeedback');
  const progressBar = document.getElementById('progressBar');
  const progressCircle = document.getElementById('progressCircle');
  const progressLabel = document.getElementById('progressLabel');

  const PROGRESS_KEY = 'fisica_tema7_progress';
  let progressState = JSON.parse(localStorage.getItem(PROGRESS_KEY) || '{}');
  if (!progressState.done) progressState.done = [];

  function saveProgress() {
    localStorage.setItem(PROGRESS_KEY, JSON.stringify(progressState));
  }

  function updateProgressUI() {
    const total = tests.length;
    const done = progressState.done.length;
    const percent = Math.round((done / total) * 100);

    progressBar.style.width = percent + '%';
    progressCircle.textContent = percent + '%';
    progressCircle.style.setProperty('--prog-deg', percent * 3.6 + 'deg');
    progressLabel.textContent = `${done} / ${total} –∑–∞–¥–∞–Ω–∏–π`;
  }

  function loadTest() {
    if (tests.length === 0) return;
    currentTestIndex = (currentTestIndex + tests.length) % tests.length;
    const t = tests[currentTestIndex];

    testQuestion.textContent = t.q;
    testOptions.innerHTML = '';
    testFeedback.textContent = '';

    t.options.forEach((opt, idx) => {
      const btn = document.createElement('button');
      btn.className = 'test-option';
      btn.textContent = opt;

      btn.addEventListener('click', () => {
        const already = progressState.done.includes(currentTestIndex);

        if (idx === t.correct) {if (idx === t.correct) {
   ...
} else {
   ...
}// --- LOG TO SUPABASE ---
await supa.from("study_logs").insert({
   subject: "fisica",
   topic: "tema7",
   question_id: currentTestIndex,
   correct: false,
   timestamp: new Date().toISOString()
});


          btn.classList.add('correct');
          testFeedback.textContent = '‚úÖ –í–µ—Ä–Ω–æ! ' + t.explain;
          if (!already) {
            progressState.done.push(currentTestIndex);// --- LOG TO SUPABASE ---
await supa.from("study_logs").insert({
   subject: "fisica",
   topic: "tema7",
   question_id: currentTestIndex,
   correct: true,
   timestamp: new Date().toISOString()
});

            saveProgress();
            updateProgressUI();
          }
        } else {
          btn.classList.add('wrong');
          testFeedback.textContent = '‚ùå –ù–µ —Å–æ–≤—Å–µ–º. ' + t.explain;
        }

        // –±–ª–æ–∫–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ
        Array.from(testOptions.children).forEach(b => b.disabled = true);
        setTimeout(() => {
          // —Å–ª–µ–¥—É—é—â–∏–π —Ç–µ—Å—Ç
          currentTestIndex = (currentTestIndex + 1) % tests.length;
          loadTest();
        }, 1400);
      });

      testOptions.appendChild(btn);
    });
  }

  updateProgressUI();
  loadTest();

  // ====== –í–†–ï–ú–Ø –ó–ê–ù–Ø–¢–ò–Ø ======
  const sessionInfo = document.getElementById('sessionInfo');
  const totalMinutesSpan = document.getElementById('totalMinutes');

  if (!progressState.totalSeconds) progressState.totalSeconds = 0;
  if (!progressState.todayDate) progressState.todayDate = '';
  if (!progressState.todaySeconds) progressState.todaySeconds = 0;

  function formatMinutes(sec) {
    const m = Math.round(sec / 60);
    return m + ' –º–∏–Ω';
  }

  function updateTimeUI() {
    const todayText = formatMinutes(progressState.todaySeconds);
    const totalText = formatMinutes(progressState.totalSeconds);
    sessionInfo.querySelector('strong').textContent = todayText;
    totalMinutesSpan.textContent = totalText;
  }

  updateTimeUI();

  const now = new Date();
  const todayStr = now.toISOString().slice(0,10);
  if (progressState.todayDate !== todayStr) {
    progressState.todayDate = todayStr;
    progressState.todaySeconds = 0;
    saveProgress();
    updateTimeUI();
  }

  setInterval(() => {
    progressState.totalSeconds += 10;
    progressState.todaySeconds += 10;
    saveProgress();setInterval(async () => {
  await supa.from("study_logs").insert({
    subject: "fisica",
    topic: "tema7",
    action: "time",
    seconds: 10,
    timestamp: new Date().toISOString()
  });
}, 10000);

    updateTimeUI();
  }, 10000);

  // ====== –°–õ–û–í–ê–†–ù–´–ô –¢–†–ï–ù–ê–ñ–Å–† ======
  let vocabIndex = 0;
  let vocabMode = 'es-ru'; // –∏–ª–∏ 'ru-es'

  const vocabWordEl = document.getElementById('vocabWord');
  const vocabAnswerEl = document.getElementById('vocabAnswer');
  const vocabFeedbackEl = document.getElementById('vocabFeedback');
  const vocabModeLabel = document.getElementById('vocabModeLabel');

  function loadVocab() {
    vocabIndex = (vocabIndex + vocab.length) % vocab.length;
    const item = vocab[vocabIndex];

    if (vocabMode === 'es-ru') {
      vocabWordEl.innerHTML = `${item.es}<span class="lang">ES</span>`;
      vocabAnswerEl.placeholder = '–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π‚Ä¶';
    } else {
      vocabWordEl.innerHTML = `${item.ru}<span class="lang">RU</span>`;
      vocabAnswerEl.placeholder = '–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∏—Å–ø–∞–Ω—Å–∫–∏–π‚Ä¶';
    }
    vocabAnswerEl.value = '';
    vocabFeedbackEl.textContent = '';
  }

  function checkVocab() {
    const item = vocab[vocabIndex];
    const user = vocabAnswerEl.value.trim().toLowerCase();
    if (!user) {
      vocabFeedbackEl.textContent = '–ù–∞–ø–∏—à–∏ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –∏–ª–∏ –Ω–∞–∂–º–∏ ¬´–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç¬ª.';
      return;
    }
    let correct;
    if (vocabMode === 'es-ru') {
      correct = item.ru.toLowerCase();
    } else {
      correct = item.es.toLowerCase();
    }
    if (correct.includes(user) || user.includes(correct)) {
      vocabFeedbackEl.textContent = '‚úÖ –û—Ç–ª–∏—á–Ω–æ!';
    } else {
      vocabFeedbackEl.textContent = `‚ÑπÔ∏è –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correct}`;
    }
  }

  function showVocabAnswer() {
    const item = vocab[vocabIndex];
    vocabFeedbackEl.textContent =
      vocabMode === 'es-ru'
        ? `–û—Ç–≤–µ—Ç: ${item.ru}`
        : `Respuesta: ${item.es}`;
  }

  document.getElementById('checkVocab').addEventListener('click', checkVocab);
  document.getElementById('showVocab').addEventListener('click', showVocabAnswer);
  document.getElementById('switchVocabMode').addEventListener('click', () => {
    vocabMode = vocabMode === 'es-ru' ? 'ru-es' : 'es-ru';
    vocabModeLabel.textContent = vocabMode === 'es-ru' ? 'ES ‚Üí RU' : 'RU ‚Üí ES';
    loadVocab();
  });

  vocabAnswerEl.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      checkVocab();
    }
  });

  loadVocab();

  // ====== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –†–ï–ñ–ò–ú–û–í (–¢–µ–æ—Ä–∏—è / –¢–µ—Å—Ç—ã / –°–ª–æ–≤–∞—Ä—å) ======
  const modeTabs = document.querySelectorAll('.mode-tab');
  const mainInner = document.getElementById('main-inner');
  const testPanel = document.getElementById('testPanel');
  const vocabPanel = document.getElementById('vocabPanel');

  function setMode(mode) {
    modeTabs.forEach(tab => {
      tab.classList.toggle('active', tab.dataset.mode === mode);
    });
    mainInner.classList.remove('mode-theory', 'mode-tests', 'mode-vocab');
    mainInner.classList.add('mode-' + mode);

    // –ù–µ–±–æ–ª—å—à–æ–π –∞–∫—Ü–µ–Ω—Ç: –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç —Ä–µ–∂–∏–º "–¢–µ—Å—Ç—ã" ‚Äì –ø–æ–¥—Å–≤–µ—Ç–∏–º –ø–∞–Ω–µ–ª—å —Ç–µ—Å—Ç–æ–≤
    if (mode === 'tests') {
      testPanel.style.boxShadow = '0 0 0 1px rgba(56,189,248,0.8)';
      vocabPanel.style.boxShadow = 'none';
    } else if (mode === 'vocab') {
      vocabPanel.style.boxShadow = '0 0 0 1px rgba(56,189,248,0.8)';
      testPanel.style.boxShadow = 'none';
    } else {
      testPanel.style.boxShadow = 'none';
      vocabPanel.style.boxShadow = 'none';
    }
  }

  modeTabs.forEach(tab => {
    tab.addEventListener('click', () => {
      setMode(tab.dataset.mode);
    });
  });

  setMode('theory');

  // –∫–ª–∏–∫–∏ –ø–æ "—á–∏–ø–∞–º" ‚Äì —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å–ª–æ–≤—É
  cardsContainer.addEventListener('click', (e) => {
    const chip = e.target.closest('.chip');
    if (!chip) return;
    const word = chip.dataset.chip || '';
    document.getElementById('searchInput').value = word.split('¬∑')[0].trim();
    renderCards(word.split('¬∑')[0].trim());
  });

</script>
</body>
</html>
